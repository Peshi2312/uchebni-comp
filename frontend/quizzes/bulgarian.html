<!DOCTYPE html>
<html lang="bg">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>–ë—ä–ª–≥–∞—Ä—Å–∫–∏ –µ–∑–∏–∫ - SoftQuiz</title>
    <link rel="stylesheet" href="../project.css">
    <link rel="stylesheet" href="quiz.css">
</head>

<body>
    <header class="site-header">
        <div class="header-left">
            <img class="site-logo" src="../../b_50cfaf10b4a8d8ca72c0074ca7ced57e.png" alt="SoftUni logo">
        </div>
        <nav class="header-nav">
            <a href="../project.html" class="nav-link">HOME</a>
            <a href="../select.html" class="nav-link">–ü–†–ï–î–ú–ï–¢–ò</a>
        </nav>
    </header>
    <main class="quiz-container">
        <div class="quiz-progress">–í—ä–ø—Ä–æ—Å <span id="currentQuestion">1</span> –æ—Ç <span id="totalQuestions">10</span>
        </div>
        <div class="quiz-box">
            <div id="question" class="question">
                <div class="timer">20</div>
                <h2>–ö–æ—è –æ—Ç –¥—É–º–∏—Ç–µ –µ —Å—ä—â–µ—Å—Ç–≤–∏—Ç–µ–ª–Ω–æ –∏–º–µ?</h2>
            </div>
            <div class="answers">
                <button class="answer-btn" onclick="checkAnswer(this)" data-correct="true">–∫–Ω–∏–≥–∞</button>
                <button class="answer-btn" onclick="checkAnswer(this)">—á–µ—Ç–∞</button>
                <button class="answer-btn" onclick="checkAnswer(this)">–±—ä—Ä–∑</button>
                <button class="answer-btn" onclick="checkAnswer(this)">–∫—Ä–∞—Å–∏–≤–æ</button>
            </div>
            <div class="quiz-actions">
                <button id="hintBtn" class="hint-btn" type="button" onclick="showHint()">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                <button id="nextBtn" class="next-btn" onclick="nextQuestion()" disabled>–°–ª–µ–¥–≤–∞—â –≤—ä–ø—Ä–æ—Å</button>
            </div>
            <div id="hintBox" class="hint-box" aria-live="polite" hidden></div>
        </div>
    </main>
    <script>
        const questions = [
            {
                question: "–ö–æ—è –æ—Ç –¥—É–º–∏—Ç–µ –µ —Å—ä—â–µ—Å—Ç–≤–∏—Ç–µ–ª–Ω–æ –∏–º–µ?",
                answers: ["–∫–Ω–∏–≥–∞", "—á–µ—Ç–∞", "–±—ä—Ä–∑", "–∫—Ä–∞—Å–∏–≤–æ"],
                correct: 0,
                hint: "–°—ä—â–µ—Å—Ç–≤–∏—Ç–µ–ª–Ω–∏—Ç–µ –∏–º–µ–Ω–∞ –Ω–∞–∑–æ–≤–∞–≤–∞—Ç –ø—Ä–µ–¥–º–µ—Ç–∏. –ü–æ–º–∏—Å–ª–∏ –∫–æ–∏ –¥—É–º–∏ –Ω–∞–∑–æ–≤–∞–≤–∞—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏ –Ω–µ—â–∞."
            },
            {
                question: "–í –∫–æ–µ –∏–∑—Ä–µ—á–µ–Ω–∏–µ –∏–º–∞ –≥–ª–∞–≥–æ–ª?",
                answers: ["–î–µ–Ω—è—Ç –µ —Å–ª—ä–Ω—á–µ–≤.", "–¢–æ–π –ø–∏—à–µ –ø–∏—Å–º–æ.", "–ö—Ä–∞—Å–∏–≤–∞ –≥—Ä–∞–¥–∏–Ω–∞.", "–°–∏–Ω—å–æ –Ω–µ–±–µ."],
                correct: 1,
                hint: "–ì–ª–∞–≥–æ–ª–∏—Ç–µ –æ–ø–∏—Å–≤–∞—Ç –∫–∞–∫–≤–æ –¥–µ–ª–∞–º–µ. –ö–æ–µ –∏–∑—Ä–µ—á–µ–Ω–∏–µ –∏–º–∞ –¥—É–º–∞, –∫–æ—è—Ç–æ –ø–æ–∫–∞–∑–≤–∞ –¥–µ–π—Å—Ç–≤–∏–µ?"
            },
            {
                question: "–ö–æ—è –¥—É–º–∞ –µ —Å–∏–Ω–æ–Ω–∏–º –Ω–∞ '—Ö—Ä–∞–±—ä—Ä'?",
                answers: ["—Å—Ç—Ä–∞—Ö–ª–∏–≤", "—Å–º–µ–ª", "—Ç—ä–∂–µ–Ω", "–≤–µ—Å–µ–ª"],
                correct: 1,
                hint: "–°–∏–Ω–æ–Ω–∏–º –∏–º–∞—Ç –±–ª–∏–∑–∫–æ –∑–Ω–∞—á–µ–Ω–∏–µ. –ö–æ–µ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª–Ω–æ –µ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ –Ω–∞ '—Å—Ç—Ä–∞—Ö–ª–∏–≤'?"
            },
            {
                question: "–ö–∞–∫—ä–≤ –µ –ø—Ä–∞–≤–∏–ª–Ω–∏—è—Ç –ø—Ä–∞–≤–æ–ø–∏—Å?",
                answers: ["–≤—Ä—ä—Å—Ç–Ω–∏–∫", "–≤—Ä—ä–∑–¥—É—Ö", "–≤—ä—Ä–∑–µ–ª", "–≤—Ä—ä–∑–∫–∞"],
                correct: 3,
                hint: "–†–∞–∑–¥–µ–ª–∏ –≤—Å—è–∫–∞ –¥—É–º–∞ –Ω–∞ —Å—Ä–∏—á–∫–∏. –ö–æ—è –∑–≤—É—á–∏ –ø—Ä–∞–≤–∏–ª–Ω–æ –ø—Ä–∏ –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ?"
            },
            {
                question: "–ö–æ–µ –∏–∑—Ä–µ—á–µ–Ω–∏–µ –µ –≤—ä–∑–∫–ª–∏—Ü–∞—Ç–µ–ª–Ω–æ?",
                answers: ["–ö–æ–≥–∞ —â–µ –¥–æ–π–¥–µ—à", "–î–Ω–µ—Å –µ —Å–ª—ä–Ω—á–µ–≤–æ", "–ö–æ–ª–∫–æ –µ –∫—Ä–∞—Å–∏–≤–æ!", "–ú–æ–∂–µ –±–∏ —É—Ç—Ä–µ"],
                correct: 2,
                hint: "–í—ä–∑–∫–ª–∏—Ü–∞—Ç–µ–ª–Ω–∏—Ç–µ –∏–∑—Ä–µ—á–µ–Ω–∏—è –ø–æ–∫–∞–∑–≤–∞—Ç —Å–∏–ª–Ω–∏ —á—É–≤—Å—Ç–≤–∞. –ö–æ–µ –∏–∑—Ä–µ—á–µ–Ω–∏–µ —Ç—Ä–∞–∂–∏ –µ–º–æ—Ü–∏—è –∏ –≤–æ—Å—Ç–æ—Ä–≥?"
            },
            {
                question: "–ö–æ—è –¥—É–º–∞ –µ –∞–Ω—Ç–æ–Ω–∏–º –Ω–∞ '—Å–≤–µ—Ç—ä–ª'?",
                answers: ["—Ç—ä–º–µ–Ω", "—è—Ä—ä–∫", "–±–ª–µ—Å—Ç—è—â", "—Å–∏—è–µ–Ω"],
                correct: 0,
                hint: "–ê–Ω—Ç–æ–Ω–∏–º –∏–º–∞—Ç –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ. –ö–æ–µ—Ç–æ –µ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ—Å—Ç –Ω–∞ —Å–≤–µ—Ç–ª–æ—Ç–æ?"
            },
            {
                question: "–í –∫–æ—è –¥—É–º–∞ –∏–º–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–∫–∞?",
                answers: ["–º–æ—Ä–µ", "—Ä–∏–±–∞", "–ø–æ–¥–≤–æ–¥–Ω–∏—Ü–∞", "–≤–æ–¥–∞"],
                correct: 2,
                hint: "–ü—Ä–µ–¥—Å—Ç–∞–≤–∫–∞—Ç–∞ –µ –ø—Ä–µ–¥–ª–æ–≥ –≤ –Ω–∞—á–∞–ª–æ—Ç–æ –Ω–∞ –¥—É–º–∞—Ç–∞. –ö–æ—è –¥—É–º–∞ –∑–∞–ø–æ—á–≤–∞ —Å –Ω–∞—Å—Ç–∞–≤–∫–∞ –∫–∞—Ç–æ '–ø–æ–¥', '–ø–æ', '–ø—Ä–µ–¥'?"
            },
            {
                question: "–ö–æ–π –µ –∞–≤—Ç–æ—Ä—ä—Ç –Ω–∞ '–ü–æ–¥ –∏–≥–æ—Ç–æ'?",
                answers: ["–•—Ä–∏—Å—Ç–æ –ë–æ—Ç–µ–≤", "–ò–≤–∞–Ω –í–∞–∑–æ–≤", "–ï–ª–∏–Ω –ü–µ–ª–∏–Ω", "–ô–æ—Ä–¥–∞–Ω –ô–æ–≤–∫–æ–≤"],
                correct: 1,
                hint: "–¢–æ–∑–∏ –∞–≤—Ç–æ—Ä –µ –∫–ª–∞—Å–∏–∫ –≤ –±—ä–ª–≥–∞—Ä—Å–∫–∞—Ç–∞ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞, –∏–∑–≤–µ—Å—Ç–µ–Ω —Å—ä—Å —Å–≤–æ–∏—Ç–µ —Ä–æ–º–∞–Ω–∏. –ü–æ–º–∏—Å–ª–∏ –∑–∞ –∏–∑–≤–µ—Å—Ç–Ω–∏—è –ø–∏—Å–∞—Ç–µ–ª –æ—Ç 19-—Ç–∏ –≤–µ–∫."
            },
            {
                question: "–ö–∞–∫–≤–∞ —á–∞—Å—Ç –Ω–∞ —Ä–µ—á—Ç–∞ –µ –¥—É–º–∞—Ç–∞ '–±—ä—Ä–∑–æ'?",
                answers: ["—Å—ä—â–µ—Å—Ç–≤–∏—Ç–µ–ª–Ω–æ", "–ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª–Ω–æ", "–Ω–∞—Ä–µ—á–∏–µ", "–≥–ª–∞–≥–æ–ª"],
                correct: 2,
                hint: "–ù–∞—Ä–µ—á–∏—Ü–∏—Ç–µ –æ–ø–∏—Å–≤–∞—Ç –∫–∞–∫ —Å–µ –¥–µ–ª–∞—Ç –¥–µ–π—Å—Ç–≤–∏—è. '–ë—ä—Ä–∑–æ' –æ–ø–∏—Å–≤–∞ –Ω–∞—á–∏–Ω–∞, –ø–æ –∫–æ–π—Ç–æ –¥–µ–π—Å—Ç–≤–∞–º–µ."
            },
            {
                question: "–ö–æ–ª–∫–æ —Å—Ä–∏—á–∫–∏ –∏–º–∞ –≤ –¥—É–º–∞—Ç–∞ '—É—á–∏–ª–∏—â–µ'?",
                answers: ["–¥–≤–µ", "—Ç—Ä–∏", "—á–µ—Ç–∏—Ä–∏", "–ø–µ—Ç"],
                correct: 2,
                hint: "–ü—Ä–µ—Å–º–µ—Ç–Ω–∏ –±—Ä–æ—è –Ω–∞ —á–∞—Å—Ç–∏—Ç–µ –≤ –¥—É–º–∞—Ç–∞ –∫–∞—Ç–æ —Ä–∞–∑–¥–µ–ª–∏—à –ø–æ –≤–æ–∫–∞–ª–∏. –£-—á–∏-–ª–∏-—â–µ."
            }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let timer = null;
        const QUESTION_TIME = 20;

        // Start timer when page loads
        window.onload = () => {
            startTimer();
        };

        function startTimer() {
            clearInterval(timer);
            let timeLeft = QUESTION_TIME;
            const timerElement = document.querySelector('.timer');
            timerElement.textContent = timeLeft;
            timerElement.classList.remove('warning');

            timer = setInterval(() => {
                timeLeft--;
                timerElement.textContent = timeLeft;

                if (timeLeft <= 5) {
                    timerElement.classList.add('warning');
                }

                if (timeLeft <= 0) {
                    clearInterval(timer);
                    const buttons = document.querySelectorAll('.answer-btn');
                    buttons.forEach(btn => {
                        btn.disabled = true;
                        if (btn.getAttribute('data-correct') === 'true') {
                            btn.classList.add('correct');
                        }
                    });
                    document.getElementById('nextBtn').disabled = false;
                    
                    // Auto-advance to next question after 2 seconds
                    setTimeout(() => {
                        nextQuestion();
                    }, 2000);
                }
            }, 1000);
        }

        function checkAnswer(button) {
            clearInterval(timer);
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(btn => {
                btn.disabled = true;
                if (btn.getAttribute('data-correct') === 'true') {
                    btn.classList.add('correct');
                }
            });

            const correct = button.getAttribute('data-correct') === 'true';
            if (!correct) {
                button.classList.add('wrong');
            }

            if (correct) {
                score++;
            }

            document.getElementById('nextBtn').disabled = false;
        }

        function nextQuestion() {
            currentQuestionIndex++;
            const questionNum = document.getElementById('currentQuestion');
            questionNum.textContent = currentQuestionIndex + 1;

            if (currentQuestionIndex >= questions.length) {
                showResult();
                return;
            }

            const question = questions[currentQuestionIndex];
            document.querySelector('.question h2').textContent = question.question;

            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach((btn, index) => {
                btn.textContent = question.answers[index];
                btn.disabled = false;
                btn.className = 'answer-btn';
                btn.setAttribute('data-correct', index === question.correct);
            });

            // hide hint and update hint text for new question
            const hintBox = document.getElementById('hintBox');
            hintBox.hidden = true;
            hintBox.textContent = question.hint || '';

            document.getElementById('nextBtn').disabled = true;
            startTimer();
        }

        async function showHint() {
            const hintBox = document.getElementById('hintBox');
            const hintBtn = document.getElementById('hintBtn');
            const question = questions[currentQuestionIndex];

            // Show loading state
            hintBox.textContent = '–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Ö–∏–Ω—Ç...';
            hintBox.hidden = false;
            hintBtn.disabled = true;

            try {
                const response = await fetch('http://localhost:3000/api/hint', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ question: question.question }),
                });

                if (!response.ok) {
                    throw new Error('Failed to fetch hint');
                }

                const data = await response.json();
                hintBox.textContent = data.hint || '–ù—è–º–∞ –Ω–∞–ª–∏—á–µ–Ω —Ö–∏–Ω—Ç.';
            } catch (error) {
                console.error('Error fetching hint:', error);
                hintBox.textContent = question.hint || '–ù–µ —É—Å–ø—è –¥–∞ —Å–µ –∑–∞—Ä–µ–¥—è—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏—Ç–µ. –û–ø–∏—Ç–∞–π—Ç–µ –ø–∞–∫.';
            } finally {
                hintBtn.disabled = false;
            }
        }

        function calculateGrade(score, total) {
            const percentage = (score / total) * 100;
            if (percentage >= 90) return "–û—Ç–ª–∏—á–µ–Ω 6";
            if (percentage >= 80) return "–ú–Ω–æ–≥–æ –¥–æ–±—ä—Ä 5";
            if (percentage >= 70) return "–î–æ–±—ä—Ä 4";
            if (percentage >= 60) return "–°—Ä–µ–¥–µ–Ω 3";
            return "–°–ª–∞–± 2";
        }

        function getEmojiForPercentage(percentage) {
            if (percentage >= 90) return 'üèÜüòÑ';
            if (percentage >= 80) return 'üòÉ';
            if (percentage >= 70) return 'üôÇ';
            if (percentage >= 60) return 'üòê';
            return 'üòû';
        }

        function showResult() {
            const quizBox = document.querySelector('.quiz-box');
            const grade = calculateGrade(score, questions.length);
            const percentage = Math.round((score / questions.length) * 100);
            const emoji = getEmojiForPercentage(percentage);

            quizBox.innerHTML = `
                <div class="result">
                    <h2>–†–µ–∑—É–ª—Ç–∞—Ç: ${score} –æ—Ç ${questions.length}</h2>
                    <div class="grade-box">
                        <div class="grade-emoji">${emoji}</div>
                        <p class="percentage">${percentage}% –≤–µ—Ä–Ω–∏ –æ—Ç–≥–æ–≤–æ—Ä–∏</p>
                        <p class="final-grade">–ö—Ä–∞–π–Ω–∞ –æ—Ü–µ–Ω–∫–∞: ${grade}</p>
                    </div>
                    <button class="restart-btn" onclick="location.reload()">–û–ø–∏—Ç–∞–π –ø–∞–∫</button>
                    <a href="../select.html" class="back-btn">–ò–∑–±–µ—Ä–∏ –¥—Ä—É–≥ –ø—Ä–µ–¥–º–µ—Ç</a>
                </div>
            `;
        }
    </script>
</body>

</html>