<!DOCTYPE html>
<html lang="bg">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>–ë–∏–æ–ª–æ–≥–∏—è - SoftQuiz</title>
    <link rel="stylesheet" href="../project.css">
    <link rel="stylesheet" href="quiz.css">
</head>

<body>
    <header class="site-header">
        <div class="header-left">
            <img class="site-logo" src="../b_50cfaf10b4a8d8ca72c0074ca7ced57e.png" alt="SoftUni logo">
        </div>
        <nav class="header-nav">
            <a href="../project.html" class="nav-link">HOME</a>
            <a href="../select.html" class="nav-link">–ü–†–ï–î–ú–ï–¢–ò</a>
        </nav>
    </header>
    <main class="quiz-container">
        <div class="quiz-progress">–í—ä–ø—Ä–æ—Å <span id="currentQuestion">1</span> –æ—Ç <span id="totalQuestions">10</span>
        </div>
        <div class="quiz-box">
            <div id="question" class="question">
                <h2>–ö–æ–π –µ –Ω–∞–π-–º–∞–ª–∫–∏—è—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–µ–Ω –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–∞ –∂–∏–≤–∏—Ç–µ –æ—Ä–≥–∞–Ω–∏–∑–º–∏?</h2>
                <div class="timer">20</div>
            </div>
            <div class="answers">
                <button class="answer-btn" onclick="checkAnswer(this)" data-correct="true">–ö–ª–µ—Ç–∫–∞</button>
                <button class="answer-btn" onclick="checkAnswer(this)">–¢—ä–∫–∞–Ω</button>
                <button class="answer-btn" onclick="checkAnswer(this)">–û—Ä–≥–∞–Ω</button>
                <button class="answer-btn" onclick="checkAnswer(this)">–ú–æ–ª–µ–∫—É–ª–∞</button>
            </div>
            <div class="quiz-actions">
                <button id="hintBtn" class="hint-btn" type="button" onclick="showHint()">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                <button id="nextBtn" class="next-btn" onclick="nextQuestion()" disabled>–°–ª–µ–¥–≤–∞—â –≤—ä–ø—Ä–æ—Å</button>
            </div>
            <div id="hintBox" class="hint-box" aria-live="polite" hidden></div>
        </div>
    </main>
    <script>
        const questions = [
            { question: "–ö–æ–π –µ –Ω–∞–π-–º–∞–ª–∫–∏—è—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–µ–Ω –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–∞ –∂–∏–≤–∏—Ç–µ –æ—Ä–≥–∞–Ω–∏–∑–º–∏?", answers: ["–ö–ª–µ—Ç–∫–∞", "–¢—ä–∫–∞–Ω", "–û—Ä–≥–∞–Ω", "–ú–æ–ª–µ–∫—É–ª–∞"], correct: 0, hint: "–ü–æ–º–∏—Å–ª–∏ –∑–∞ –Ω–∞–π-–º–∞–ª–∫–∞—Ç–∞ –µ–¥–∏–Ω–∏—Ü–∞ –Ω–∞ –∂–∏–≤–∏ –æ—Ä–≥–∞–Ω–∏–∑–º–∏. –¢—ä–∫–∞–Ω–∏—Ç–µ —Å–∞ —Å—ä—Å—Ç–∞–≤–µ–Ω–∏ –æ—Ç –Ω–µ—â–æ –ø–æ-–º–∞–ª–∫–æ." },
            { question: "–ö–æ–π –ø—Ä–æ—Ü–µ—Å –ø—Ä–µ–≤—Ä—ä—â–∞ —Å–≤–µ—Ç–ª–∏–Ω–Ω–∞—Ç–∞ –µ–Ω–µ—Ä–≥–∏—è –≤ —Ö–∏–º–∏—á–Ω–∞ –ø—Ä–∏ —Ä–∞—Å—Ç–µ–Ω–∏—è—Ç–∞?", answers: ["–î–∏—à–∞–Ω–µ", "–§–æ—Ç–æ—Å–∏–Ω—Ç–µ–∑–∞", "–•—Ä–∞–Ω–µ–Ω–µ", "–†–∞—Å—Ç–µ–∂"], correct: 1, hint: "–†–∞—Å—Ç–µ–Ω–∏—è—Ç–∞ —Å–∞ –∑–µ–ª–µ–Ω–∏ –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω–∏–µ –Ω–∞ –µ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å. –ö–∞–∫—ä–≤ –ø—Ä–æ—Ü–µ—Å –æ—Ç–±–µ–ª—è–∑–≤–∞ –∑–µ–ª–µ–Ω–æ—Ç–æ —Ä–∞—Å—Ç–µ–Ω–∏–µ?" },
            { question: "–ö–æ–µ –µ –Ω–∞–π-–≥–æ–ª—è–º–æ—Ç–æ —á–æ–≤–µ—à–∫–æ –≤—ä—Ç—Ä–µ—à–Ω–æ –æ—Ä–≥–∞–Ω–∏—á–Ω–æ —Ü—è–ª–æ?", answers: ["–°—ä—Ä—Ü–µ", "–ß–µ—Ä–µ–Ω –¥—Ä–æ–±", "–ë—è–ª –¥—Ä–æ–±", "–ú–æ–∑—ä–∫"], correct: 1, hint: "–ü–æ–º–∏—Å–ª–∏ –∫–æ–π –æ—Ä–≥–∞–Ω –ø—Ä–µ–º–∞—Ö–≤–∞ —Ç–æ–∫—Å–∏–Ω–∏—Ç–µ –æ—Ç —Ç—è–ª–æ—Ç–æ. –¢–æ–π –µ –µ–¥–∏–Ω –æ—Ç –Ω–∞–π-–≥–æ–ª–µ–º–∏—Ç–µ." },
            { question: "–ö–æ–ª–∫–æ —Ö—Ä–æ–º–æ–∑–æ–º–Ω–∏ –¥–≤–æ–π–∫–∏ –∏–º–∞ –≤ —á–æ–≤–µ—à–∫–∞—Ç–∞ –∫–ª–µ—Ç–∫–∞?", answers: ["21", "22", "23", "24"], correct: 2, hint: "–í—Å–µ–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑—ä–º –∏–º–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ–Ω –±—Ä–æ–π —Ö—Ä–æ–º–æ–∑–æ–º–∏. –ü–æ–º–∏—Å–ª–∏ –¥–∞–ª–∏ –µ –±–ª–∏–∑–æ –¥–æ 20 –∏–ª–∏ 25." },
            { question: "–ö–æ–π –≤–∏—Ç–∞–º–∏–Ω —Å–µ –ø—Ä–æ–∏–∑–≤–µ–∂–¥–∞ –æ—Ç –∫–æ–∂–∞—Ç–∞ –ø—Ä–∏ –∏–∑–ª–∞–≥–∞–Ω–µ –Ω–∞ —Å–ª—ä–Ω—á–µ–≤–∞ —Å–≤–µ—Ç–ª–∏–Ω–∞?", answers: ["–í–∏—Ç–∞–º–∏–Ω D", "–í–∏—Ç–∞–º–∏–Ω C", "–í–∏—Ç–∞–º–∏–Ω A", "–í–∏—Ç–∞–º–∏–Ω B"], correct: 0, hint: "–ö–æ–≥–∞—Ç–æ —Å–∏ –Ω–∞ —Å–ª—ä–Ω—Ü–µ, –∫–æ–∂–∞—Ç–∞ —Ç–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏ –µ–¥–∏–Ω —Å–ø–µ—Ü–∏–∞–ª–µ–Ω –≤–∏—Ç–∞–º–∏–Ω. –ö–∞–∫—ä–≤ –µ —Ç–æ–π?" },
            { question: "–ö–æ—è –µ –Ω–∞–π-–≥–æ–ª—è–º–∞—Ç–∞ –∞—Ä—Ç–µ—Ä–∏—è –≤ —á–æ–≤–µ—à–∫–æ—Ç–æ —Ç—è–ª–æ?", answers: ["–ê–æ—Ä—Ç–∞", "–í–µ–Ω–∞ –∫–∞–≤–∞", "–ë–µ–ª–æ–¥—Ä–æ–±–Ω–∞ –∞—Ä—Ç–µ—Ä–∏—è", "–ö–æ—Ä–æ–Ω–∞—Ä–Ω–∞ –∞—Ä—Ç–µ—Ä–∏—è"], correct: 0, hint: "–ü–æ–º–∏—Å–ª–∏ –∑–∞ –≥–ª–∞–≤–Ω–∏—è –∫—Ä—ä–≤–µ–Ω —Å—ä–¥, –∫–æ–π—Ç–æ –∏–∑–ª–∏–∑–∞ –æ—Ç —Å—ä—Ä—Ü–µ—Ç–æ. –¢–æ–π –µ –Ω–∞–π-–≥–æ–ª—è–º." },
            { question: "–ö–æ–π –æ—Ä–≥–∞–Ω –ø—Ä–µ—á–∏—Å—Ç–≤–∞ –∫—Ä—ä–≤—Ç–∞ –æ—Ç —Ç–æ–∫—Å–∏–Ω–∏?", answers: ["–°—ä—Ä—Ü–µ", "–ë—ä–±—Ä–µ—Ü–∏", "–ß–µ—Ä–µ–Ω –¥—Ä–æ–±", "–î–∞–ª–∞–∫"], correct: 1, hint: "–¢–æ–∑–∏ –æ—Ä–≥–∞–Ω —Ñ–∏–ª—Ç—Ä–∏—Ä–∞ –æ—Ç–ø–∞–¥–Ω–∏ –≤–µ—â–µ—Å—Ç–≤–∞ –æ—Ç –∫—Ä—ä–≤—Ç–∞. –ö–æ–ª–∫–æ —Ç–∞–∫–∏–≤–∞ –æ—Ä–≥–∞–Ω–∞ –∏–º–∞ –æ–±–∏–∫–Ω–æ–≤–µ–Ω–æ —É —á–æ–≤–µ–∫–∞?" },
            { question: "–ö–æ–µ –µ –æ—Å–Ω–æ–≤–Ω–æ—Ç–æ –≥–æ—Ä–∏–≤–æ –∑–∞ –º–æ–∑—ä–∫–∞?", answers: ["–ì–ª—é–∫–æ–∑–∞", "–§—Ä—É–∫—Ç–æ–∑–∞", "–ü—Ä–æ—Ç–µ–∏–Ω–∏", "–ú–∞–∑–Ω–∏–Ω–∏"], correct: 0, hint: "–ú–æ–∑—ä–∫—ä—Ç –µ –≥–ª–∞–∂–¥–∞—á –µ–Ω–µ—Ä–≥–∏—è. –ü–æ–º–∏—Å–ª–∏ –∫–æ–π –∑–∞—Ö–∞—Ä–µ–Ω —Ç–∏–ø –≥–æ —Ö—Ä–∞–Ω–≤–∞ –ø—Ä–µ–¥–∏–º–Ω–æ." },
            { question: "–ö–∞–∫–≤–∞ –µ –Ω–æ—Ä–º–∞–ª–Ω–∞—Ç–∞ —Ç–µ–ª–µ—Å–Ω–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞ —á–æ–≤–µ–∫–∞?", answers: ["35.5¬∞C", "36.6¬∞C", "37.5¬∞C", "38.0¬∞C"], correct: 1, hint: "–ó–¥—Ä–∞–≤–∞—Ç–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –µ –æ–∫–æ–ª–æ —Å—Ç–∞–π–Ω–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –Ω–æ –º–∞–ª–∫–æ –ø–æ-–≤–∏—Å–æ–∫–∞. –ü–æ–º–∏—Å–ª–∏ –º–µ–∂–¥—É 36 –∏ 37." },
            { question: "–ö–æ–π –µ –Ω–∞–π-–≥–æ–ª–µ–º–∏—è—Ç –æ—Ä–≥–∞–Ω –≤ —á–æ–≤–µ—à–∫–æ—Ç–æ —Ç—è–ª–æ?", answers: ["–ß–µ—Ä–µ–Ω –¥—Ä–æ–±", "–ú–æ–∑—ä–∫", "–ö–æ–∂–∞", "–ë—è–ª –¥—Ä–æ–±"], correct: 2, hint: "–û—Ä–≥–∞–Ω—ä—Ç, –∫–æ–π—Ç–æ –ø–æ–∫—Ä–∏–≤–∞ —Ü—è–ª–æ—Ç–æ —Ç–∏ —Ç—è–ª–æ. –¢–æ–π –µ –∏ –Ω–∞–π-–≥–æ–ª—è–º–∞—Ç–∞ –ø–æ–≤—ä—Ä—Ö–Ω–æ—Å—Ç." }
        ];

        let currentQuestionIndex = 0;
        let score = 0;
        let timer = null;
        const QUESTION_TIME = 20;

        // Start timer when page loads
        window.onload = () => {
            startTimer();
        };

        function startTimer() {
            clearInterval(timer);
            let timeLeft = QUESTION_TIME;
            const timerElement = document.querySelector('.timer');
            timerElement.textContent = timeLeft;
            timerElement.classList.remove('warning');

            timer = setInterval(() => {
                timeLeft--;
                timerElement.textContent = timeLeft;

                if (timeLeft <= 5) {
                    timerElement.classList.add('warning');
                }

                if (timeLeft <= 0) {
                    clearInterval(timer);
                    const buttons = document.querySelectorAll('.answer-btn');
                    buttons.forEach(btn => {
                        btn.disabled = true;
                        if (btn.getAttribute('data-correct') === 'true') {
                            btn.classList.add('correct');
                        }
                    });
                    document.getElementById('nextBtn').disabled = false;
                }
            }, 1000);
        }

        function checkAnswer(button) {
            clearInterval(timer);
            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach(btn => {
                btn.disabled = true;
                if (btn.getAttribute('data-correct') === 'true') {
                    btn.classList.add('correct');
                }
            });

            const correct = button.getAttribute('data-correct') === 'true';
            if (!correct) {
                button.classList.add('wrong');
            }

            if (correct) {
                score++;
            }

            document.getElementById('nextBtn').disabled = false;
        }

        function nextQuestion() {
            currentQuestionIndex++;
            const questionNum = document.getElementById('currentQuestion');
            questionNum.textContent = currentQuestionIndex + 1;

            if (currentQuestionIndex >= questions.length) {
                showResult();
                return;
            }

            const question = questions[currentQuestionIndex];
            document.querySelector('.question h2').textContent = question.question;

            const buttons = document.querySelectorAll('.answer-btn');
            buttons.forEach((btn, index) => {
                btn.textContent = question.answers[index];
                btn.disabled = false;
                btn.className = 'answer-btn';
                btn.setAttribute('data-correct', index === question.correct);
            });

            const hintBox = document.getElementById('hintBox');
            hintBox.hidden = true;
            hintBox.textContent = question.hint || '';

            document.getElementById('nextBtn').disabled = true;
            startTimer();
        }

        async function showHint() {
            const hintBox = document.getElementById('hintBox');
            const hintBtn = document.getElementById('hintBtn');
            const question = questions[currentQuestionIndex];

            // Show loading state
            hintBox.textContent = '–ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Ö–∏–Ω—Ç...';
            hintBox.hidden = false;
            hintBtn.disabled = true;

            try {
                const response = await fetch('http://localhost:3000/api/hint', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ question: question.question }),
                });

                if (!response.ok) {
                    throw new Error('Failed to fetch hint');
                }

                const data = await response.json();
                hintBox.textContent = data.hint || '–ù—è–º–∞ –Ω–∞–ª–∏—á–µ–Ω —Ö–∏–Ω—Ç.';
            } catch (error) {
                console.error('Error fetching hint:', error);
                hintBox.textContent = question.hint || '–ù–µ —É—Å–ø—è –¥–∞ —Å–µ –∑–∞—Ä–µ–¥—è—Ç –ø–æ–¥—Å–∫–∞–∑–∫–∏—Ç–µ. –û–ø–∏—Ç–∞–π—Ç–µ –ø–∞–∫.';
            } finally {
                hintBtn.disabled = false;
            }
        }

        function calculateGrade(score, total) {
            const percentage = (score / total) * 100;
            if (percentage >= 90) return "–û—Ç–ª–∏—á–µ–Ω 6";
            if (percentage >= 80) return "–ú–Ω–æ–≥–æ –¥–æ–±—ä—Ä 5";
            if (percentage >= 70) return "–î–æ–±—ä—Ä 4";
            if (percentage >= 60) return "–°—Ä–µ–¥–µ–Ω 3";
            return "–°–ª–∞–± 2";
        }

        function getEmojiForPercentage(percentage) {
            if (percentage >= 90) return 'üèÜüòÑ';
            if (percentage >= 80) return 'üòÉ';
            if (percentage >= 70) return 'üôÇ';
            if (percentage >= 60) return 'üòê';
            return 'üòû';
        }

        function showResult() {
            const quizBox = document.querySelector('.quiz-box');
            const grade = calculateGrade(score, questions.length);
            const percentage = Math.round((score / questions.length) * 100);
            const emoji = getEmojiForPercentage(percentage);

            quizBox.innerHTML = `
                <div class="result">
                    <h2>–†–µ–∑—É–ª—Ç–∞—Ç: ${score} –æ—Ç ${questions.length}</h2>
                    <div class="grade-box">
                        <div class="grade-emoji">${emoji}</div>
                        <p class="percentage">${percentage}% –≤–µ—Ä–Ω–∏ –æ—Ç–≥–æ–≤–æ—Ä–∏</p>
                        <p class="final-grade">–ö—Ä–∞–π–Ω–∞ –æ—Ü–µ–Ω–∫–∞: ${grade}</p>
                    </div>
                    <button class="restart-btn" onclick="location.reload()">–û–ø–∏—Ç–∞–π –ø–∞–∫</button>
                    <a href="../select.html" class="back-btn">–ò–∑–±–µ—Ä–∏ –¥—Ä—É–≥ –ø—Ä–µ–¥–º–µ—Ç</a>
                </div>
            `;
        }
    </script>
</body>

</html>